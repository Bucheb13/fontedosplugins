module.exports=[10479,a=>{"use strict";var b=a.i(87924),c=a.i(38246),d=a.i(72131),e=a.i(49789);async function f(a){let b=await a.text();try{return b?JSON.parse(b):{}}catch{return{erro:b||"Resposta inválida do servidor"}}}function g(a){return a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"")}function h(){let{senhaAdmin:a,setMensagem:h,setAcaoHeader:i}=(0,e.useAdmin)(),[j,k]=(0,d.useState)([]),[l,m]=(0,d.useState)(!1),[n,o]=(0,d.useState)(""),[p,q]=(0,d.useState)(""),[r,s]=(0,d.useState)(""),[t,u]=(0,d.useState)(""),[v,w]=(0,d.useState)(""),[x,y]=(0,d.useState)(""),[z,A]=(0,d.useState)(!0),[B,C]=(0,d.useState)(!1),[D,E]=(0,d.useState)("video"),[F,G]=(0,d.useState)(""),[H,I]=(0,d.useState)(null),[J,K]=(0,d.useState)(null),L=(0,d.useRef)(null),M=(0,d.useRef)(null),[N,O]=(0,d.useState)(!1),[P,Q]=(0,d.useState)(null);async function R(){if(h(null),!a)return h("Digite a senha do admin.");m(!0);let b=await fetch("/api/admin/drum-kit/listar",{headers:{"x-senha-admin":a},cache:"no-store"}),c=await f(b);if(m(!1),!b.ok)return h(c?.erro??"Erro ao carregar drum-kits.");k(c.itens??[])}async function S(){if(h(null),!a)return h("Digite a senha do admin.");let b=p.trim(),c=g(r.trim());if(!b)return h("Nome obrigatório.");if(!c)return h("Slug obrigatório.");if(!H)return h("Envie a capa.");if(!J)return h("Envie o torrent.");if("video"===D&&!x.trim())return h("Informe a URL do vídeo.");if("texto"===D&&!F.trim())return h("Informe o manual escrito.");O(!0);let d=new FormData;d.append("nome",b),d.append("slug",c),d.append("subtitulo",t.trim()),d.append("descricao",v.trim()),d.append("tipo_instalacao",D),"video"===D?d.append("conteudo_instalacao",x.trim()):d.append("conteudo_instalacao",F.trim()),d.append("ativo",String(z)),d.append("capa",H),d.append("torrent",J);let e=await fetch("/api/admin/drum-kit/criar",{method:"POST",headers:{"x-senha-admin":a},body:d}),i=await f(e);if(O(!1),!e.ok)return h(i?.erro??"Erro ao criar drum-kit.");i.drumKit&&k(a=>[i.drumKit,...a]),q(""),s(""),u(""),w(""),y(""),I(null),K(null),h("Drum-Kit criado com sucesso.")}async function T(b){if(!a||!confirm(`Excluir "${b}"?`))return;Q(b);let c=await fetch("/api/admin/drum-kit/deletar",{method:"POST",headers:{"Content-Type":"application/json","x-senha-admin":a},body:JSON.stringify({slug:b})}),d=await f(c);if(Q(null),!c.ok)return h(d?.erro??"Erro ao excluir.");k(a=>a.filter(a=>a.slug!==b)),h("DrumKit excluído.")}(0,d.useEffect)(()=>(i({rotulo:"Carregar drum-kits",carregando:l,aoClicar:R}),()=>i(null)),[i,l,a]);let U=(0,d.useMemo)(()=>{let a=n.toLowerCase();return j.filter(b=>`${b.nome} ${b.slug}`.toLowerCase().includes(a))},[j,n]);return(0,b.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,b.jsxs)("section",{className:"rounded-3xl border border-white/10 bg-white/5 p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Criar drum-kit"}),(0,b.jsxs)("div",{className:"mt-4 grid gap-4 md:grid-cols-2",children:[(0,b.jsx)("input",{placeholder:"Nome",value:p,onChange:a=>{let b=a.target.value;q(b),B||s(g(b))},className:"rounded-2xl bg-black/30 px-4 py-3"}),(0,b.jsx)("input",{placeholder:"Slug",value:r,onChange:a=>{C(!0),s(g(a.target.value))},className:"rounded-2xl bg-black/30 px-4 py-3"}),(0,b.jsx)("textarea",{placeholder:"Subtítulo",value:t,onChange:a=>u(a.target.value),className:"md:col-span-2 rounded-2xl bg-black/30 px-4 py-3"}),(0,b.jsx)("textarea",{placeholder:"Descrição",value:v,onChange:a=>w(a.target.value),rows:4,className:"md:col-span-2 rounded-2xl bg-black/30 px-4 py-3"}),(0,b.jsxs)("div",{className:"md:col-span-2 flex gap-4",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"radio",name:"tipoManual",value:"video",checked:"video"===D,onChange:()=>E("video")}),"Vídeo do YouTube"]}),(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"radio",name:"tipoManual",value:"texto",checked:"texto"===D,onChange:()=>E("texto")}),"Manual escrito"]})]}),"video"===D&&(0,b.jsx)("input",{placeholder:"URL do vídeo do YouTube",value:x,onChange:a=>y(a.target.value),className:"md:col-span-2 rounded-2xl bg-black/30 px-4 py-3"}),"texto"===D&&(0,b.jsx)("textarea",{placeholder:"Manual de instalação (texto)",value:F,onChange:a=>G(a.target.value),rows:6,className:"md:col-span-2 rounded-2xl bg-black/30 px-4 py-3"}),(0,b.jsx)("button",{type:"button",onClick:()=>L.current?.click(),className:"rounded-2xl bg-black/30 px-4 py-3 text-left",children:H?`✅ ${H.name}`:"Selecionar capa"}),(0,b.jsx)("input",{ref:L,type:"file",hidden:!0,accept:"image/*",onChange:a=>I(a.target.files?.[0]??null)}),(0,b.jsx)("button",{type:"button",onClick:()=>M.current?.click(),className:"rounded-2xl bg-black/30 px-4 py-3 text-left",children:J?`✅ ${J.name}`:"Selecionar torrent"}),(0,b.jsx)("input",{ref:M,type:"file",hidden:!0,accept:".torrent",onChange:a=>K(a.target.files?.[0]??null)}),(0,b.jsxs)("div",{className:"md:col-span-2 flex justify-between items-center",children:[(0,b.jsxs)("label",{className:"flex gap-2 items-center",children:[(0,b.jsx)("input",{type:"checkbox",checked:z,onChange:a=>A(a.target.checked)}),"Ativo"]}),(0,b.jsx)("button",{onClick:S,disabled:N,className:"rounded-2xl bg-white px-6 py-3 text-black font-semibold",children:N?"Criando…":"Criar drum-kit"})]})]})]}),(0,b.jsxs)("section",{className:"rounded-3xl border border-white/10 bg-white/5 p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Drum-Kits cadastrados"}),(0,b.jsx)("input",{placeholder:"Buscar...",value:n,onChange:a=>o(a.target.value),className:"mb-4 w-full rounded-2xl bg-black/30 px-4 py-3"}),(0,b.jsx)("div",{className:"space-y-3",children:U.map(a=>(0,b.jsxs)("div",{className:"flex justify-between items-center rounded-2xl bg-black/20 p-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-semibold",children:a.nome}),(0,b.jsx)("div",{className:"text-xs text-white/60",children:a.slug})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(c.default,{href:`/admin/drum-kit/${a.slug}`,className:"px-4 py-2 text-xs rounded-xl bg-black/30",children:"Editar"}),(0,b.jsx)("button",{onClick:()=>T(a.slug),disabled:P===a.slug,className:"px-4 py-2 text-xs rounded-xl bg-black/30",children:P===a.slug?"Excluindo…":"Excluir"})]})]},a.id))})]})]})}a.s(["default",()=>h])}];

//# sourceMappingURL=src_app_admin_drum-kit_page_tsx_1038e6a5._.js.map