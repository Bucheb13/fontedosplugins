module.exports=[25642,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d({message:a,type:d,onClose:e,duration:f=1e4}){return(0,c.useEffect)(()=>{let a=setTimeout(e,f);return()=>clearTimeout(a)},[e,f]),(0,b.jsx)("div",{className:"fixed top-16 left-1/2 z-50 -translate-x-1/2 animate-[slideIn_0.35s_ease-out]",children:(0,b.jsx)("div",{className:`rounded-xl border bg-black/80 px-4 py-3 text-sm backdrop-blur ${{success:"border-green-400/40 text-green-300 shadow-[0_0_25px_rgba(34,197,94,0.45)]",error:"border-red-500/40 text-red-300 shadow-[0_0_25px_rgba(239,68,68,0.45)]",info:"border-cyan-400/40 text-cyan-300 shadow-[0_0_25px_rgba(34,211,238,0.45)]"}[d]}`,children:a})})}a.s(["CyberToast",()=>d])},55677,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(55679),f=a.i(25642);let g=[{id:"mensal",nome:"Mensal",preco:"R$ 7,00",valor:7,descricao:"Acesso completo por 1 mês."},{id:"anual",nome:"Anual",preco:"R$ 22,00",valor:22,descricao:"Acesso completo por 12 meses.",destaque:!0}];function h(a){return"object"==typeof a&&null!==a&&("ativa"===a.status||"inativa"===a.status)&&("mensal"===a.tipo||"anual"===a.tipo)&&"string"==typeof a.periodo_fim}function i(){let a=(0,d.useRouter)(),i=(0,e.criarSupabaseNavegador)(),[j,k]=(0,c.useState)(null),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)({}),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)(null),z=(a,b="success")=>{let c=crypto.randomUUID();w(d=>[...d,{id:c,message:a,type:b}])};(0,c.useEffect)(()=>{i.auth.getUser().then(({data:a})=>k(a.user??null))},[i]),(0,c.useEffect)(()=>{j&&i.from("assinaturas").select("status, tipo, periodo_fim").eq("usuario_id",j.id).order("criado_em",{ascending:!1}).limit(1).maybeSingle().then(({data:a})=>{a&&h(a)?m(a):m(null)})},[j,i]),(0,c.useEffect)(()=>{if(!j)return;let a=i.channel(`assinaturas-${j.id}`).on("postgres_changes",{event:"*",schema:"public",table:"assinaturas",filter:`usuario_id=eq.${j.id}`},a=>{a.new&&h(a.new)&&"ativa"===a.new.status&&(m(a.new),z("Assinatura ativada!","success"),s(null),u(null))}).subscribe();return()=>{i.removeChannel(a)}},[j,i]);let A=async b=>{if(!j)return a.push("/login");let c=p.replace(/\D/g,"");if(11!==c.length)return void z("CPF inválido","error");y(b.id),o(a=>({...a,[b.id]:!0})),s(null),u(null);try{let a=await fetch("/api/pagamentos/ggpix/criar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usuario_id:j.id,nome:j.user_metadata?.nome??"Cliente",email:j.email,cpf:c,valor:b.valor})}),d=await a.json();if(!a.ok||!d.qr_code_url)throw Error("Erro PIX");s(d.qr_code_url),u(d.copia_cola),z("PIX gerado com sucesso!","success")}catch{z("Erro ao gerar PIX","error")}finally{o(a=>({...a,[b.id]:!1})),y(null)}},B=(0,c.useMemo)(()=>!!l&&"ativa"===l.status&&new Date(l.periodo_fim)>=new Date,[l]);return(0,b.jsxs)("section",{className:"mx-auto max-w-6xl px-4 py-16",children:[v.map(a=>(0,b.jsx)(f.CyberToast,{message:a.message,type:a.type,onClose:()=>{let b;return b=a.id,w(a=>a.filter(a=>a.id!==b))},duration:4e3},a.id)),(0,b.jsxs)("header",{className:"text-center mb-12",children:[(0,b.jsx)("h1",{className:"text-5xl font-bold text-cyan-400",children:"Assinaturas"}),(0,b.jsx)("p",{className:"mt-2 text-purple-300",children:"FonteDosPlugins"})]}),B&&l?(0,b.jsxs)("div",{className:"max-w-xl mx-auto rounded-3xl p-8 bg-black/30 border border-green-400 text-center",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-green-400 mb-2",children:"Assinatura ativa"}),(0,b.jsxs)("p",{className:"text-white",children:["Plano: ",(0,b.jsx)("strong",{className:"capitalize",children:l.tipo})]}),(0,b.jsxs)("p",{className:"text-white mt-1",children:["Válida até: ",(0,b.jsx)("strong",{children:new Date(l.periodo_fim).toLocaleDateString("pt-BR")})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"max-w-md mx-auto mb-10",children:(0,b.jsx)("input",{type:"text",placeholder:"Digite seu CPF",value:p,onChange:a=>q(a.target.value),className:"w-full rounded-xl bg-black/20 border p-3 text-white"})}),(0,b.jsx)("div",{className:"grid md:grid-cols-2 gap-8",children:g.map(a=>(0,b.jsxs)("div",{className:`rounded-3xl p-8 border ${x===a.id?"border-cyan-400 bg-black/30 shadow-[0_0_20px_cyan]":"bg-black/20"}`,children:[(0,b.jsx)("h2",{className:"text-2xl text-cyan-400",children:a.nome}),(0,b.jsx)("p",{className:"text-3xl text-white mt-3",children:a.preco}),(0,b.jsx)("p",{className:"text-white/70 mt-2",children:a.descricao}),(0,b.jsx)("button",{onClick:()=>A(a),disabled:n[a.id],className:"mt-6 w-full border py-3 rounded-xl text-cyan-400 hover:bg-white/10 transition",children:n[a.id]?"Gerando PIX...":"Pagar com PIX"})]},a.id))})]}),r&&t&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:(0,b.jsxs)("div",{className:"bg-zinc-900 rounded-3xl p-6 w-full max-w-md text-center border border-cyan-400 shadow-lg",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold text-cyan-400 mb-4",children:"Pague com PIX"}),(0,b.jsx)("img",{src:r,alt:"QR Code PIX",className:"mx-auto mb-4 rounded-lg bg-white p-2"}),(0,b.jsx)("textarea",{readOnly:!0,value:t,className:"w-full bg-black/20 text-white p-3 rounded-lg text-sm mb-4",rows:4}),(0,b.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(t),z("Código PIX copiado!","success")},className:"w-full mb-3 border border-green-500 text-green-400 rounded-lg py-2 font-semibold hover:text-white hover:shadow-[0_0_15px_green] transition",children:"Copiar código PIX"}),(0,b.jsx)("button",{onClick:()=>{s(null),u(null)},className:"w-full text-red-400 border border-red-400 py-2 rounded-lg hover:text-white hover:shadow-[0_0_15px_red] transition font-semibold",children:"Fechar"}),(0,b.jsx)("p",{className:"mt-4 text-white/60 text-sm",children:"Após o pagamento, sua assinatura será ativada automaticamente."})]})})]})}a.s(["default",()=>i])}];

//# sourceMappingURL=src_dfbfe4e6._.js.map