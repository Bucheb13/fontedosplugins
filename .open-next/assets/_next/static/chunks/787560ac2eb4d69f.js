(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55963,e=>{"use strict";var a=e.i(43476),t=e.i(22016),l=e.i(71645),r=e.i(32818);async function n(e){let a=await e.text();try{return a?JSON.parse(a):{}}catch{return{erro:a||"Resposta inválida do servidor"}}}function s(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"")}function i(){let{senhaAdmin:e,setMensagem:i,setAcaoHeader:o}=(0,r.useAdmin)(),[d,c]=(0,l.useState)([]),[u,p]=(0,l.useState)(!1),[m,x]=(0,l.useState)(""),[h,g]=(0,l.useState)(""),[b,f]=(0,l.useState)(""),[v,j]=(0,l.useState)(""),[k,N]=(0,l.useState)(""),[y,C]=(0,l.useState)(""),[S,w]=(0,l.useState)(!0),[E,T]=(0,l.useState)(!1),[D,K]=(0,l.useState)("video"),[R,$]=(0,l.useState)(""),[O,L]=(0,l.useState)(null),[M,A]=(0,l.useState)(null),P=(0,l.useRef)(null),U=(0,l.useRef)(null),[B,_]=(0,l.useState)(!1),[z,F]=(0,l.useState)(null);async function I(){if(i(null),!e)return i("Digite a senha do admin.");p(!0);let a=await fetch("/api/admin/drum-kit/listar",{headers:{"x-senha-admin":e},cache:"no-store"}),t=await n(a);if(p(!1),!a.ok)return i(t?.erro??"Erro ao carregar drum-kits.");c(t.itens??[])}async function J(){if(i(null),!e)return i("Digite a senha do admin.");let a=h.trim(),t=s(b.trim());if(!a)return i("Nome obrigatório.");if(!t)return i("Slug obrigatório.");if(!O)return i("Envie a capa.");if(!M)return i("Envie o torrent.");if("video"===D&&!y.trim())return i("Informe a URL do vídeo.");if("texto"===D&&!R.trim())return i("Informe o manual escrito.");_(!0);let l=new FormData;l.append("nome",a),l.append("slug",t),l.append("subtitulo",v.trim()),l.append("descricao",k.trim()),l.append("tipo_instalacao",D),"video"===D?l.append("conteudo_instalacao",y.trim()):l.append("conteudo_instalacao",R.trim()),l.append("ativo",String(S)),l.append("capa",O),l.append("torrent",M);let r=await fetch("/api/admin/drum-kit/criar",{method:"POST",headers:{"x-senha-admin":e},body:l}),o=await n(r);if(_(!1),!r.ok)return i(o?.erro??"Erro ao criar drum-kit.");o.drumKit&&c(e=>[o.drumKit,...e]),g(""),f(""),j(""),N(""),C(""),L(null),A(null),i("Drum-Kit criado com sucesso.")}async function Y(a){if(!e||!confirm(`Excluir "${a}"?`))return;F(a);let t=await fetch("/api/admin/drum-kit/deletar",{method:"POST",headers:{"Content-Type":"application/json","x-senha-admin":e},body:JSON.stringify({slug:a})}),l=await n(t);if(F(null),!t.ok)return i(l?.erro??"Erro ao excluir.");c(e=>e.filter(e=>e.slug!==a)),i("DrumKit excluído.")}(0,l.useEffect)(()=>(o({rotulo:"Carregar drum-kits",carregando:u,aoClicar:I}),()=>o(null)),[o,u,e]);let V=(0,l.useMemo)(()=>{let e=m.toLowerCase();return d.filter(a=>`${a.nome} ${a.slug}`.toLowerCase().includes(e))},[d,m]);return(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsxs)("section",{className:"rounded-3xl border border-white/10 bg-white/5 p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Criar drum-kit"}),(0,a.jsxs)("div",{className:"mt-4 grid gap-4 md:grid-cols-2",children:[(0,a.jsx)("input",{placeholder:"Nome",value:h,onChange:e=>{let a=e.target.value;g(a),E||f(s(a))},className:"rounded-2xl bg-black/30 px-4 py-3"}),(0,a.jsx)("input",{placeholder:"Slug",value:b,onChange:e=>{T(!0),f(s(e.target.value))},className:"rounded-2xl bg-black/30 px-4 py-3"}),(0,a.jsx)("textarea",{placeholder:"Subtítulo",value:v,onChange:e=>j(e.target.value),className:"md:col-span-2 rounded-2xl bg-black/30 px-4 py-3"}),(0,a.jsx)("textarea",{placeholder:"Descrição",value:k,onChange:e=>N(e.target.value),rows:4,className:"md:col-span-2 rounded-2xl bg-black/30 px-4 py-3"}),(0,a.jsxs)("div",{className:"md:col-span-2 flex gap-4",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"tipoManual",value:"video",checked:"video"===D,onChange:()=>K("video")}),"Vídeo do YouTube"]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"tipoManual",value:"texto",checked:"texto"===D,onChange:()=>K("texto")}),"Manual escrito"]})]}),"video"===D&&(0,a.jsx)("input",{placeholder:"URL do vídeo do YouTube",value:y,onChange:e=>C(e.target.value),className:"md:col-span-2 rounded-2xl bg-black/30 px-4 py-3"}),"texto"===D&&(0,a.jsx)("textarea",{placeholder:"Manual de instalação (texto)",value:R,onChange:e=>$(e.target.value),rows:6,className:"md:col-span-2 rounded-2xl bg-black/30 px-4 py-3"}),(0,a.jsx)("button",{type:"button",onClick:()=>P.current?.click(),className:"rounded-2xl bg-black/30 px-4 py-3 text-left",children:O?`✅ ${O.name}`:"Selecionar capa"}),(0,a.jsx)("input",{ref:P,type:"file",hidden:!0,accept:"image/*",onChange:e=>L(e.target.files?.[0]??null)}),(0,a.jsx)("button",{type:"button",onClick:()=>U.current?.click(),className:"rounded-2xl bg-black/30 px-4 py-3 text-left",children:M?`✅ ${M.name}`:"Selecionar torrent"}),(0,a.jsx)("input",{ref:U,type:"file",hidden:!0,accept:".torrent",onChange:e=>A(e.target.files?.[0]??null)}),(0,a.jsxs)("div",{className:"md:col-span-2 flex justify-between items-center",children:[(0,a.jsxs)("label",{className:"flex gap-2 items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:S,onChange:e=>w(e.target.checked)}),"Ativo"]}),(0,a.jsx)("button",{onClick:J,disabled:B,className:"rounded-2xl bg-white px-6 py-3 text-black font-semibold",children:B?"Criando…":"Criar drum-kit"})]})]})]}),(0,a.jsxs)("section",{className:"rounded-3xl border border-white/10 bg-white/5 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Drum-Kits cadastrados"}),(0,a.jsx)("input",{placeholder:"Buscar...",value:m,onChange:e=>x(e.target.value),className:"mb-4 w-full rounded-2xl bg-black/30 px-4 py-3"}),(0,a.jsx)("div",{className:"space-y-3",children:V.map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center rounded-2xl bg-black/20 p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:e.nome}),(0,a.jsx)("div",{className:"text-xs text-white/60",children:e.slug})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(t.default,{href:`/admin/drum-kit/${e.slug}`,className:"px-4 py-2 text-xs rounded-xl bg-black/30",children:"Editar"}),(0,a.jsx)("button",{onClick:()=>Y(e.slug),disabled:z===e.slug,className:"px-4 py-2 text-xs rounded-xl bg-black/30",children:z===e.slug?"Excluindo…":"Excluir"})]})]},e.id))})]})]})}e.s(["default",()=>i])}]);