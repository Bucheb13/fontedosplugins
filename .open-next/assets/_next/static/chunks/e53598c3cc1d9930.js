(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,32171,e=>{"use strict";var a=e.i(43476),t=e.i(22016),r=e.i(71645),l=e.i(32818);async function n(e){let a=await e.text();try{return a?JSON.parse(a):{}}catch{return{erro:a||"Resposta inválida do servidor"}}}function s(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"")}function o(){let{senhaAdmin:e,setMensagem:o,setAcaoHeader:i}=(0,l.useAdmin)(),[c,d]=(0,r.useState)([]),[u,p]=(0,r.useState)(!1),[m,x]=(0,r.useState)(""),[g,h]=(0,r.useState)(""),[b,f]=(0,r.useState)(""),[v,j]=(0,r.useState)(""),[N,y]=(0,r.useState)(""),[k,C]=(0,r.useState)(""),[S,w]=(0,r.useState)(!0),[E,T]=(0,r.useState)(!1),[P,R]=(0,r.useState)("video"),[$,O]=(0,r.useState)(""),[D,L]=(0,r.useState)(null),[M,A]=(0,r.useState)(null),U=(0,r.useRef)(null),B=(0,r.useRef)(null),[_,z]=(0,r.useState)(!1),[F,I]=(0,r.useState)(null);async function J(){if(o(null),!e)return o("Digite a senha do admin.");p(!0);let a=await fetch("/api/admin/programas/listar",{headers:{"x-senha-admin":e},cache:"no-store"}),t=await n(a);if(p(!1),!a.ok)return o(t?.erro??"Erro ao carregar programas.");d(t.itens??[])}async function K(){if(o(null),!e)return o("Digite a senha do admin.");let a=g.trim(),t=s(b.trim());if(!a)return o("Nome obrigatório.");if(!t)return o("Slug obrigatório.");if(!D)return o("Envie a capa.");if(!M)return o("Envie o torrent.");if("video"===P&&!k.trim())return o("Informe a URL do vídeo.");if("texto"===P&&!$.trim())return o("Informe o manual escrito.");z(!0);let r=new FormData;r.append("nome",a),r.append("slug",t),r.append("subtitulo",v.trim()),r.append("descricao",N.trim()),r.append("tipo_instalacao",P),"video"===P?r.append("conteudo_instalacao",k.trim()):r.append("conteudo_instalacao",$.trim()),r.append("ativo",String(S)),r.append("capa",D),r.append("torrent",M);let l=await fetch("/api/admin/programas/criar",{method:"POST",headers:{"x-senha-admin":e},body:r}),i=await n(l);if(z(!1),!l.ok)return o(i?.erro??"Erro ao criar programa.");i.programa&&d(e=>[i.programa,...e]),h(""),f(""),j(""),y(""),C(""),L(null),A(null),o("Programa criado com sucesso.")}async function Y(a){if(!e||!confirm(`Excluir "${a}"?`))return;I(a);let t=await fetch("/api/admin/programas/deletar",{method:"POST",headers:{"Content-Type":"application/json","x-senha-admin":e},body:JSON.stringify({slug:a})}),r=await n(t);if(I(null),!t.ok)return o(r?.erro??"Erro ao excluir.");d(e=>e.filter(e=>e.slug!==a)),o("Programa excluído.")}(0,r.useEffect)(()=>(i({rotulo:"Carregar programas",carregando:u,aoClicar:J}),()=>i(null)),[i,u,e]);let V=(0,r.useMemo)(()=>{let e=m.toLowerCase();return c.filter(a=>`${a.nome} ${a.slug}`.toLowerCase().includes(e))},[c,m]);return(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsxs)("section",{className:"rounded-3xl border border-white/10 bg-white/5 p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Criar programa"}),(0,a.jsxs)("div",{className:"mt-4 grid gap-4 md:grid-cols-2",children:[(0,a.jsx)("input",{placeholder:"Nome",value:g,onChange:e=>{let a=e.target.value;h(a),E||f(s(a))},className:"rounded-2xl bg-black/30 px-4 py-3"}),(0,a.jsx)("input",{placeholder:"Slug",value:b,onChange:e=>{T(!0),f(s(e.target.value))},className:"rounded-2xl bg-black/30 px-4 py-3"}),(0,a.jsx)("textarea",{placeholder:"Subtítulo",value:v,onChange:e=>j(e.target.value),className:"md:col-span-2 rounded-2xl bg-black/30 px-4 py-3"}),(0,a.jsx)("textarea",{placeholder:"Descrição",value:N,onChange:e=>y(e.target.value),rows:4,className:"md:col-span-2 rounded-2xl bg-black/30 px-4 py-3"}),(0,a.jsxs)("div",{className:"md:col-span-2 flex gap-4",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"tipoManual",value:"video",checked:"video"===P,onChange:()=>R("video")}),"Vídeo do YouTube"]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"tipoManual",value:"texto",checked:"texto"===P,onChange:()=>R("texto")}),"Manual escrito"]})]}),"video"===P&&(0,a.jsx)("input",{placeholder:"URL do vídeo do YouTube",value:k,onChange:e=>C(e.target.value),className:"md:col-span-2 rounded-2xl bg-black/30 px-4 py-3"}),"texto"===P&&(0,a.jsx)("textarea",{placeholder:"Manual de instalação (texto)",value:$,onChange:e=>O(e.target.value),rows:6,className:"md:col-span-2 rounded-2xl bg-black/30 px-4 py-3"}),(0,a.jsx)("button",{type:"button",onClick:()=>U.current?.click(),className:"rounded-2xl bg-black/30 px-4 py-3 text-left",children:D?`✅ ${D.name}`:"Selecionar capa"}),(0,a.jsx)("input",{ref:U,type:"file",hidden:!0,accept:"image/*",onChange:e=>L(e.target.files?.[0]??null)}),(0,a.jsx)("button",{type:"button",onClick:()=>B.current?.click(),className:"rounded-2xl bg-black/30 px-4 py-3 text-left",children:M?`✅ ${M.name}`:"Selecionar torrent"}),(0,a.jsx)("input",{ref:B,type:"file",hidden:!0,accept:".torrent",onChange:e=>A(e.target.files?.[0]??null)}),(0,a.jsxs)("div",{className:"md:col-span-2 flex justify-between items-center",children:[(0,a.jsxs)("label",{className:"flex gap-2 items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:S,onChange:e=>w(e.target.checked)}),"Ativo"]}),(0,a.jsx)("button",{onClick:K,disabled:_,className:"rounded-2xl bg-white px-6 py-3 text-black font-semibold",children:_?"Criando…":"Criar programa"})]})]})]}),(0,a.jsxs)("section",{className:"rounded-3xl border border-white/10 bg-white/5 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Programas cadastrados"}),(0,a.jsx)("input",{placeholder:"Buscar...",value:m,onChange:e=>x(e.target.value),className:"mb-4 w-full rounded-2xl bg-black/30 px-4 py-3"}),(0,a.jsx)("div",{className:"space-y-3",children:V.map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center rounded-2xl bg-black/20 p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:e.nome}),(0,a.jsx)("div",{className:"text-xs text-white/60",children:e.slug})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(t.default,{href:`/admin/programas/${e.slug}`,className:"px-4 py-2 text-xs rounded-xl bg-black/30",children:"Editar"}),(0,a.jsx)("button",{onClick:()=>Y(e.slug),disabled:F===e.slug,className:"px-4 py-2 text-xs rounded-xl bg-black/30",children:F===e.slug?"Excluindo…":"Excluir"})]})]},e.id))})]})]})}e.s(["default",()=>o])}]);